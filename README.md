# Automated Photo Tagging & Organization in Social Media Platforms Using face recognition technology 

> Revolutionizing how users manage and explore their digital memories.  

---

## üìå Overview  

Social media users upload millions of photos daily, but **manual tagging** of friends and family is inefficient and often incomplete. Our project leverages **Machine Learning (Haar Cascade + PCA + SVM)** to automatically **detect, recognize, and tag faces** in uploaded photos.  

This system reduces the burden of manual tagging, improves user experience, and enables faster organization of digital photo libraries.  

---

## üéì Academic Context

- **Module**: Artificial Intelligence and Machine Learning (AIML- IT2011)
- **University**: Sri Lanka Institute of Information Technology (SLIIT)
- **Department**: Faculty of Computing
- **Year**: 2st Year
- **Semester**: 1nd Semester
- **Academic Year**: 2025
- **Project Type**: AI Application Development Project

---

## üéØ Problem Domain: Social Media & Digital Content Management  

1. **Manual Tagging Inefficiency**  
   - Users spend significant time tagging photos.  
   - Many photos remain untagged ‚Üí disorganized galleries.  

2. **Automated Solution Benefits**  
   - Instantly find and tag people.  
   - Encourage more interaction on the platform.  
   - Save user time and effort.  

3. **Broader Applications**  
   - Beyond social media ‚Üí can be used in personal photo libraries, event albums, or enterprise image management systems.  

---

## üóÇÔ∏è Dataset: Labeled Faces in the Wild (LFW)  

We selected the **LFW dataset**, a robust benchmark for face recognition research, well-suited to our real-world problem.  

- **Scale:** Over **13,000 labeled face images**.  
- **Diversity:** **1,680 unique individuals** with multiple images each.  
- **Realism:** Photos include variations in pose, lighting, and background.  
- **Source:** [Kaggle ‚Äì LFW Dataset](https://www.kaggle.com/datasets/jessicali9530/lfw-dataset)  

### ‚úÖ Why LFW?  

- **Real-World Variability** ‚Üí Mimics typical social media uploads.  
- **Large & Diverse** ‚Üí Sufficient for model training and testing.  
- **Multiple Images per Person** ‚Üí Helps robust identification.  
- **Public & Well-Labeled** ‚Üí Perfect for supervised learning.
- 
---

## Features

- Robust face detection using a ResNet-10 SSD model
- Face embeddings generated by OpenFace (`openface_nn4.small2.v1.t7`)
- Recognition via an SVM classifier (pre-trained, stored in `output/recognizer_tuned.pickle`)
- Support for multiple faces per image
- Confidence scores and annotated result images
- Simple web UI for upload and viewing results

## Repo layout

- `app.py` ‚Äî main Flask application
- `face_detection_model/` ‚Äî Caffe model files for face detection
  - `deploy.prototxt`
  - `res10_300x300_ssd_iter_140000.caffemodel`
- `openface_nn4.small2.v1.t7` ‚Äî OpenFace embedding model
- `output/` ‚Äî saved models and encodings
  - `recognizer_tuned.pickle` ‚Äî trained classifier
  - `le.pickle` ‚Äî label encoder
  - `embeddings.pickle` ‚Äî optional embeddings file
- `static/uploads/` ‚Äî uploaded and result images
- `templates/` ‚Äî HTML templates (`index.html`, `result.html`, `base.html`)

## Key Technology
---------------

- **Flask** ‚Äî web framework
- **OpenCV** ‚Äî image processing and DNN support
- **OpenFace (NN4.small2.v1)** ‚Äî face embedding model (`openface_nn4.small2.v1.t7`)
- **Caffe SSD (ResNet-10)** ‚Äî face detector (files in `face_detection_model/`)
- **scikit-learn (SVM)** ‚Äî classifier saved in `output/recognizer_tuned.pickle`


## Technology & versions (from `requirements.txt`)

- Flask==2.3.3
- opencv-python==4.8.0.76
- opencv-contrib-python==4.8.0.76
- numpy (recommend `numpy<2.0` for compatibility with OpenCV builds)
- imutils==0.5.4
- scikit-learn==1.3.0 (model compatibility note below)
- Werkzeug==2.3.7

## Installation (Windows / PowerShell)

1. Create a virtual environment (optional but recommended):

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
```

2. Install dependencies:

```powershell
pip install -r requirements.txt
```

Note: If you encounter NumPy/OpenCV binary compatibility errors (e.g., "A module that was compiled using NumPy 1.x cannot be run in NumPy 2.x"), install a NumPy `<2.0` release:

```powershell
pip install "numpy<2.0"
pip install --upgrade opencv-python opencv-contrib-python
```

3. Ensure the model files are present:

- `face_detection_model/deploy.prototxt`
- `face_detection_model/res10_300x300_ssd_iter_140000.caffemodel`
- `openface_nn4.small2.v1.t7`
- `output/recognizer_tuned.pickle` and `output/le.pickle`

## Running the app

```powershell
python app.py
```

Then open `http://127.0.0.1:5000` in your browser.

## Usage

- Upload an image using the web UI on the home page.
- The app will detect faces, compute embeddings, predict labels and confidences, then display an annotated result image and a list of recognized faces.

## Troubleshooting & Notes

- Model unpickle warnings: You may see `InconsistentVersionWarning: Trying to unpickle estimator SVC from version X when using version Y`. This happens when the saved model was created with a different scikit-learn version. In many cases the model still works, but consider re-training or exporting model parameters if you need full compatibility.

- NumPy/OpenCV compatibility: If you see errors like `ImportError: numpy.core.multiarray failed to import` or warnings about NumPy 2.x compatibility, downgrade NumPy as shown above.

- Large uploads: `app.config['MAX_CONTENT_LENGTH']` is set to 16MB. Increase if you need to accept larger images.

- Production deploy: The built-in Flask dev server is not suitable for production. Use a WSGI server (e.g., Gunicorn on Linux) or host behind a production-ready web server.

## Extending the project

- Add a gallery and persistent storage for uploaded images and results.
- Add user authentication and per-user models.
- Provide a script to retrain/update the SVM classifier using new embeddings.
- Add GPU support for faster embedding extraction (requires appropriate OpenCV builds or a PyTorch/TensorFlow implementation).

## Acknowledgements

- OpenFace project ‚Äî for the face embedding model
- OpenCV ‚Äî for DNN and image processing utilities

## License

This project does not include a license file; add one if you plan to publish or share the code. A common choice is the MIT license.

---


